#!/bin/bash

go_version="0.0.1";
param=$1;
param_2=$2;

function help {
	echo "";
	echo "Usage: go <command>";
	echo "";
	echo "where <command> is one of:";
	echo "      -h, --help                  general help/usage of go";
	echo "      -v, --version               current version of go";
	echo "      -p, --path                  path to working directory";
	echo "      -l, --list                  list all shell scripts available";
	echo "      -c, --copy <script path>    copy script into global space";
	echo "      -r, --remove <script name>  remove shell script";
	echo "";
	echo "      <script name>               will execute given shell script";
	echo "      -f, --force <script name>   will run the script as admin user";
	echo "";
	echo "go@$go_version - global working directory: ${BASH_SOURCE[0]}";
	echo "";
}

function run_script { 
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	echo "";
	echo "--------------------";
	echo "running - $param";
	echo "--------------------";

	cd $scripts_dir

	chmod a+rwx $param;

	bash ./$param;
}

function force_run_script {
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	echo "";
	echo "--------------------";
	echo "running - sudo $param_2";
	echo "--------------------";

	cd $scripts_dir

	if [[ $param_2 ]]
	then
		chmod a+rwx $param_2;

		sudo bash ./$param_2;
	else 
		help;
	fi
}

function list_scripts {
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	echo "";
	echo $scripts_dir;

	cd $scripts_dir;

	for entry in *
	do
	  echo "|-- $entry";
	done

	echo "";

}

function copy_script {
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	if [[ $param_2 ]]
	then
		cp $param_2 $scripts_dir;
	else 
		help;
	fi

	echo "";
	echo "$param_2 added to global";
	echo "";
}

function remove_script {
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	if [[ $param_2 ]]
	then
		rm $scripts_dir/$param_2;
	else 
		help;
	fi

	echo "";
	echo "$param_2 removed from global";
	echo "";
}

function version {
	echo "";
	echo "go@$go_version";
	echo "";
}

function path {
	dir="$( dirname "${BASH_SOURCE[0]}" )";
	scripts_dir=${dir//bin/lib}"/node_modules/go/shell-scripts";

	echo "";
	echo "present working directory: `pwd`";
	echo "global working directory:  $( dirname "${BASH_SOURCE[0]}" )";
	echo "shell scripts directory:   $scripts_dir";
	echo "";
}

case "$param" in
	"")
		help;
    ;;
	-l)
		list_scripts;
    ;;
    --list)
		list_scripts;
    ;;
    -c)
		copy_script;
    ;;
    --copy)
		copy_script;
    ;;
    -r)
		remove_script;
    ;;
    --remove)
		remove_script;
    ;;
    -h)
		help;
    ;;
    --help)
		help;
    ;;
    -v)
		version;
    ;;
    --version)
		version;
    ;;
    -p)
		path;
    ;;
    --path)
		path;
    ;;
    -f)
		force_run_script;
    ;;
    --force)
		force_run_script;
    ;;
    *)
    	run_script;
    ;;
esac
